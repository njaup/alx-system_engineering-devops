#!/usr/bin/env bash

# Update system packages
sudo apt update
sudo apt upgrade -y

# Install required packages
sudo apt install -y dnsmasq

# Configure dnsmasq
echo "address=/localhost/127.0.0.2" | sudo tee -a /etc/dnsmasq.conf
echo "address=/facebook.com/8.8.8.8" | sudo tee -a /etc/dnsmasq.conf

# Restart dnsmasq service
sudo systemctl restart dnsmasq

# Verify changes
echo "Verifying changes..."
echo "Ping localhost:"
ping -c 2 localhost
echo "Ping facebook.com:"
ping -c 2 facebook.com

# If Docker is not installed, install it
if ! command -v docker &> /dev/null; then
    echo "Docker not found. Installing Docker..."
    curl -fsSL https://get.docker.com -o get-docker.sh
    sudo sh get-docker.sh
    sudo usermod -aG docker $USER
    rm get-docker.sh
fi

echo "Configuration complete."
